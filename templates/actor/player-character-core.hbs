<div class="player-character-core">
  <header class="sheet-header">
    <div class="profile-img">
      <img src="{{actor.img}}" data-action="editImage" data-field="img" alt="{{actor.name}}" />
    </div>
    <div class="header-fields">
      <h1 class="charname">
        <input name="name" type="text" value="{{actor.name}}" />
      </h1>
      <div class="character-class">
        <label for="character-class">Class</label>
        <input
          id="character-class"
          name="system.class.label"
          type="text"
          value="{{system.class.label}}"
        />
      </div>
    </div>
    <div class="header-fields tier-info">
      <label for="tier-value">Tier</label>
      <div class="tier-input">
        <input
          id="tier-value"
          name="system.tier.value"
          type="number"
          min="1"
          max="6"
          value="{{system.tier.value}}"
        />
        <span class="tier-label">{{tierLabel}}</span>
      </div>
    </div>
  </header>

  <section class="reserves">
    <h2>{{localize "TRISKEL.Actor.Reserve.Label"}}</h2>
    <div class="reserve-grid">
      {{#each reserves as |reserve key|}}
        {{#if reserve.id}}
          <div class="reserve" style="grid-area: {{key}};">
            <div class="resource-bar {{key}}">
              {{#each reserve._segments as |segment|}}
                <div
                  class="resource-box is-interactive segment-{{segment.state}}"
                  data-action="updateResourceValue"
                  data-resource="reserves.{{key}}"
                  data-resource-value="{{segment.index}}"
                >
                  {{segment.index}}
                </div>
              {{/each}}
            </div>
            <div class="resource-input" data-reserve="{{key}}">
              <div class="resource-max">
                <label class="resource-name" for="reserve-{{key}}-max" title="{{reserve.description}}">{{reserve.label}}</label>
                <input
                  id="reserve-{{key}}-max"
                  class="resource-max-input"
                  type="number"
                  data-dtype="Number"
                  name="system.reserves.{{key}}.max"
                  value="{{reserve.max}}"
                />
              </div>
              <footer class="reserve-strain">
                <span>Strains</span>
                <ul class="strain-track">
                  {{#each reserve.strain as |ischecked strainKey|}}
                    <li>
                      <label class="strain-step">
                        <input
                          type="checkbox"
                          name="system.reserves.{{key}}.strain.{{strainKey}}"
                          {{checked ischecked}}
                        />
                        <span>{{strainKey}}</span>
                      </label>
                    </li>
                  {{/each}}
                </ul>
              </footer>
            </div>
          </div>
        {{/if}}
      {{/each}}
    </div>
  </section>

  <section class="paths">
    <h2>{{localize "TRISKEL.Actor.Path.Label"}}</h2>
    <div class="paths-grid">
      {{#each paths as |path|}}
        {{#if path.id}}
          <div class="path-bar {{path.id}}" style="grid-area: {{path.id}};">
            <div class="path-label" title="{{path.description}}">{{path.label}}</div>
            <input
              id="path-{{path.id}}-max"
              class="path-max-input"
              type="number"
              min="0"
              data-dtype="Number"
              name="system.paths.{{path.id}}.max"
              value="{{path.max}}"
            />
            <div class="path-segments">
              {{#each path._segments as |segment|}}
                <div
                  class="resource-box is-interactive segment-{{segment.state}}"
                  data-action="updateResourceValue"
                  data-resource="tension"
                  data-resource-field="value"
                  data-resource-value="{{segment.index}}"
                >
                  {{segment.index}}
                </div>
              {{/each}}
              <div class="resource-spacer" style="flex-grow: {{path._spacerFlex}};"></div>
            </div>
          </div>
        {{/if}}
      {{/each}}

      <div class="tension-card">
        <label class="path-label" for="tension-value">{{localize "TRISKEL.Actor.Tension.Label"}}</label>
        <input
          id="tension-value"
          class="tension-input"
          type="number"
          min="{{system.tension.min}}"
          data-dtype="Number"
          name="system.tension.value"
          value="{{system.tension.value}}"
        />
      </div>
    </div>
  </section>

  {{!-- Sheet Tab Navigation --}}
  <nav class="sheet-tabs tabs">
    {{#each tabs as |tab|}}
      <a
        class="{{tab.cssClass}}"
        data-action="tab"
        data-group="{{tab.group}}"
        data-tab="{{tab.id}}"
        data-tooltip="{{localize tab.tooltip}}"
      >
        {{#if tab.icon}}
          <i class="{{tab.icon}}" aria-hidden="true"></i>
        {{/if}}
        {{localize tab.label}}
      </a>
    {{/each}}
  </nav>
</div>
